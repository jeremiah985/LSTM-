
# 基于pytorch的LSTM模型融合情感因子使用网络爬虫实时获取信息的股票/期货收盘价预测模型

## 项目背景与目标

本项目为青岛大学2022级图灵班大二上学期的计算机创新课程项目，旨在通过深度学习中的**LSTM**（长短期记忆网络）模型，对期货收盘价进行预测。本项目包含多维特征的预测，涵盖数据清洗、数据预处理、特征工程、模型设计、模型测试和模型可视化等多个环节。通过此项目，我们将加深对机器学习和深度学习的理解，并增强在实际项目中的编码和团队协作能力。

## 项目结构

1. **数据清洗**：处理数据中的缺失值、异常值和冗余数据，确保数据质量。
2. **数据预处理**：对数据进行归一化、标准化等处理，使其适应LSTM模型的输入要求。
3. **特征工程**：利用PCA降维等方法对多维特征进行提取和处理，选取相关特征用于预测。
4. **模型设计**：构建LSTM模型，设计合适的网络结构进行期货收盘价的预测。
5. **模型测试**：对模型进行训练和验证，调整参数以提高预测精度。
6. **模型可视化**：展示训练过程中的损失函数变化趋势，并可视化预测结果。

## 项目创新点

1. **PCA降维处理**：在多特征工程中，使用PCA进行降维处理，提取有效特征，提高模型的效率和预测精度。
   ![image](https://github.com/user-attachments/assets/8afbea63-5329-413f-b910-47be3f08c15e)
   PCA降维分析
   ![image](https://github.com/user-attachments/assets/d7c7c4a6-06c7-4fe5-8fc3-1a21608d3dbb)
   斯皮尔曼相关性分析


4. **多维特征工程**：结合多个维度的特征变量（如开盘价、SGX等相关指标），增强模型的预测能力。
5. **LSTM神经网络变体(尚未实现)**：根据不同的需求调整LSTM网络的结构，优化模型性能。
6. **情感因子提取(尚未实现)**：探索基于情感因素（如新闻、舆情等）的特征提取，进一步提升预测精度。



## 项目展示

以下是训练集合预测趋势图表和损失函数的变化趋势：


![股票价格的训练集合预测趋势图表和损失函数的变化趋势](https://github.com/user-attachments/assets/9b2e0b20-eca2-4b81-8443-e27d33389980)

预测股票价格的可视化展示：

![预测股票价格的可视化展示](https://github.com/user-attachments/assets/b491302a-837f-4744-ab26-20ff83ebf842)

## 项目状态

该项目目前仍在持续维护中，不断优化和提升模型性能，未来计划加入基于情感因子的相关预测功能。我们还将继续学习并借鉴相关类似项目的经验，以进一步提升模型的预测精度。

## 情感因子分析（数据准备-网络爬虫部分）

我们首先使用selenium在东方财富网站上爬取股票的收盘价信息，然后爬取在对应的股票论坛中股民的言论，为后续的情感因子分析做准备，对应的实现代码可以在网络爬虫的文件架中找到 

## 使用snownlp来提取不同的情感因子

## 使用pytorch+lstm来提取情感因子

## lstm时间序列和情感因子加权来预测股票趋势

